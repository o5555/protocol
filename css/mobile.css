/* Mobile-first: safe areas, overscroll, tap behavior */

:root {
  --sat: env(safe-area-inset-top);
  --sar: env(safe-area-inset-right);
  --sab: env(safe-area-inset-bottom);
  --sal: env(safe-area-inset-left);
}

/* Prevent iOS rubber-banding on the app shell */
html {
  overscroll-behavior-y: contain;
}

/* Remove tap highlight on all interactive elements */
button, a, input, select, textarea, label {
  -webkit-tap-highlight-color: transparent;
}

/* Bottom navigation: pad for notched phones */
.bottom-nav {
  padding-bottom: var(--sab);
}

/* Main content: clear notch/Dynamic Island at top, tab bar at bottom */
.app-main {
  padding-top: calc(16px + var(--sat));
  padding-bottom: calc(64px + var(--sab));
}

/* Header: pad for standalone mode status bar */
.app-header {
  padding-top: var(--sat);
}

/* Standalone PWA: extra top padding when browser chrome is hidden */
@media all and (display-mode: standalone) {
  .app-header {
    padding-top: var(--sat);
  }
}

/* Onboarding section: safe-area padding */
#onboarding-section {
  padding-top: var(--sat);
  padding-bottom: var(--sab);
}

/* Safe bottom padding for modals (iPhone notch) */
.safe-bottom {
  padding-bottom: calc(8px + var(--sab));
}

/* ── Sync Loading Screen (Oura × Whoop × Duolingo) ── */

/* Animated ring that draws itself */
@keyframes sync-ring-draw {
  0% { stroke-dashoffset: 251; }
  100% { stroke-dashoffset: 0; }
}

/* Gentle glow pulse on the ring */
@keyframes sync-ring-glow {
  0%, 100% { filter: drop-shadow(0 0 6px rgba(0, 200, 160, 0.3)); }
  50% { filter: drop-shadow(0 0 16px rgba(0, 200, 160, 0.6)); }
}

/* Moon icon floats gently */
@keyframes sync-float {
  0%, 100% { transform: translateY(0); }
  50% { transform: translateY(-4px); }
}

/* Fade-slide in for messages */
@keyframes sync-msg-in {
  0% { opacity: 0; transform: translateY(8px); }
  100% { opacity: 1; transform: translateY(0); }
}

/* Fade out for messages */
@keyframes sync-msg-out {
  0% { opacity: 1; transform: translateY(0); }
  100% { opacity: 0; transform: translateY(-8px); }
}

/* Stage dots pulse */
@keyframes sync-dot-pulse {
  0%, 100% { transform: scale(1); opacity: 0.5; }
  50% { transform: scale(1.3); opacity: 1; }
}

.sync-screen {
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  padding: 48px 24px;
  min-height: 280px;
}

.sync-ring-container {
  position: relative;
  width: 100px;
  height: 100px;
  margin-bottom: 24px;
}

.sync-ring-bg {
  stroke: rgba(42, 42, 78, 0.5);
  fill: none;
  stroke-width: 4;
}

.sync-ring-progress {
  stroke: url(#sync-gradient);
  fill: none;
  stroke-width: 4;
  stroke-linecap: round;
  stroke-dasharray: 251;
  stroke-dashoffset: 251;
  transform-origin: center;
  transform: rotate(-90deg);
  animation: sync-ring-draw 10s ease-out forwards;
}

.sync-ring-svg {
  animation: sync-ring-glow 2.5s ease-in-out infinite;
}

.sync-moon {
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  font-size: 28px;
  animation: sync-float 2s ease-in-out infinite;
}

.sync-message {
  font-size: 15px;
  font-weight: 500;
  color: #e5e7eb;
  text-align: center;
  min-height: 24px;
  margin-bottom: 6px;
}

.sync-message.entering {
  animation: sync-msg-in 0.35s ease-out forwards;
}

.sync-message.exiting {
  animation: sync-msg-out 0.25s ease-in forwards;
}

.sync-submessage {
  font-size: 12px;
  color: #6b7280;
  text-align: center;
  margin-bottom: 20px;
}

/* Whoop-style stage progress */
.sync-stages {
  display: flex;
  align-items: center;
  gap: 8px;
}

.sync-stage-dot {
  width: 6px;
  height: 6px;
  border-radius: 50%;
  background: #2a2a4e;
  transition: background 0.4s ease, transform 0.3s ease;
}

.sync-stage-dot.active {
  background: #00c8a0;
  animation: sync-dot-pulse 1s ease-in-out infinite;
}

.sync-stage-dot.done {
  background: #00c8a0;
  transform: scale(1);
  animation: none;
}

.sync-stage-bar {
  width: 28px;
  height: 2px;
  background: #2a2a4e;
  border-radius: 1px;
  position: relative;
  overflow: hidden;
}

.sync-stage-bar::after {
  content: '';
  position: absolute;
  left: 0;
  top: 0;
  height: 100%;
  width: 0%;
  background: #00c8a0;
  border-radius: 1px;
  transition: width 0.6s ease;
}

.sync-stage-bar.filled::after {
  width: 100%;
}

/* Onboarding step transition animation */
.onboarding-step-enter {
  opacity: 0;
  transform: translateY(12px);
}

.onboarding-step-active {
  opacity: 1;
  transform: translateY(0);
  transition: opacity 0.3s ease, transform 0.3s ease;
}
