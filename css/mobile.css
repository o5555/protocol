/* Mobile-first: safe areas, overscroll, tap behavior */

:root {
  --sat: env(safe-area-inset-top);
  --sar: env(safe-area-inset-right);
  --sab: env(safe-area-inset-bottom);
  --sal: env(safe-area-inset-left);
}

/* Prevent iOS rubber-banding on the app shell */
html {
  overscroll-behavior-y: contain;
}

/* Remove tap highlight on all interactive elements */
button, a, input, select, textarea, label {
  -webkit-tap-highlight-color: transparent;
}

/* Bottom navigation: pad for notched phones */
.bottom-nav {
  padding-bottom: var(--sab);
}

/* Main content: clear notch/Dynamic Island at top, tab bar at bottom */
.app-main {
  padding-top: calc(16px + var(--sat));
  padding-bottom: calc(64px + var(--sab));
}

/* Header: pad for standalone mode status bar */
.app-header {
  padding-top: var(--sat);
}

/* Standalone PWA: extra top padding when browser chrome is hidden */
@media all and (display-mode: standalone) {
  .app-header {
    padding-top: var(--sat);
  }
}

/* Onboarding section: safe-area padding */
#onboarding-section {
  padding-top: var(--sat);
  padding-bottom: var(--sab);
}

/* Safe bottom padding for modals (iPhone notch) */
.safe-bottom {
  padding-bottom: calc(8px + var(--sab));
}

/* ── Oura-style Sync Ring ── */

@keyframes dashboard-pulse {
  0%, 100% { transform: scale(1); opacity: 0.6; }
  50% { transform: scale(1.15); opacity: 1; }
}

.dashboard-pulse-logo {
  animation: dashboard-pulse 1.8s ease-in-out infinite;
}

@keyframes sync-ring-spin {
  0% { transform: rotate(0deg); }
  100% { transform: rotate(360deg); }
}

@keyframes sync-ring-glow {
  0%, 100% { filter: drop-shadow(0 0 4px rgba(0, 200, 160, 0.2)); }
  50% { filter: drop-shadow(0 0 14px rgba(0, 200, 160, 0.5)); }
}

.sync-screen {
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  padding: 48px 24px;
}

.sync-ring-container {
  position: relative;
  width: 96px;
  height: 96px;
  margin-bottom: 20px;
}

.sync-ring-svg {
  animation: sync-ring-spin 1.4s linear infinite, sync-ring-glow 2.5s ease-in-out infinite;
}

.sync-ring-bg {
  stroke: rgba(42, 42, 78, 0.4);
  fill: none;
  stroke-width: 3.5;
}

.sync-ring-progress {
  stroke: url(#sync-gradient);
  fill: none;
  stroke-width: 3.5;
  stroke-linecap: round;
  stroke-dasharray: 188 63;
  stroke-dashoffset: 0;
  transform-origin: center;
  transform: rotate(-90deg);
}

.sync-label {
  font-size: 13px;
  color: #6b7280;
  letter-spacing: 0.03em;
}

/* Onboarding step transition animation */
.onboarding-step-enter {
  opacity: 0;
  transform: translateY(12px);
}

.onboarding-step-active {
  opacity: 1;
  transform: translateY(0);
  transition: opacity 0.3s ease, transform 0.3s ease;
}

/* ── Pull-to-Refresh ── */

#ptr-indicator {
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  z-index: 50;
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 8px;
  height: 48px;
  background: #0a0a12;
  transform: translateY(0);
  opacity: 0;
  pointer-events: none;
  will-change: transform, opacity;
  /* Offset upward so it's hidden above the viewport */
  margin-top: -48px;
  padding-top: var(--sat);
}

#ptr-label {
  font-size: 13px;
  color: #6b7280;
  letter-spacing: 0.02em;
  user-select: none;
}

.ptr-ready #ptr-label {
  color: #00c8a0;
}

#ptr-spinner {
  width: 18px;
  height: 18px;
  border: 2px solid #2a2a4e;
  border-top-color: #00c8a0;
  border-radius: 50%;
  opacity: 0;
  transition: opacity 0.2s ease;
}

.ptr-ready #ptr-spinner,
.ptr-active #ptr-spinner {
  opacity: 1;
}

@keyframes ptr-spin {
  to { transform: rotate(360deg); }
}

.ptr-spinning {
  animation: ptr-spin 0.7s linear infinite;
}

/* Ensure main content has will-change for smooth pull transform */
.app-main {
  will-change: transform;
}

/* ── League Carousel ── */

#league-swipe-area {
  touch-action: pan-y;
}

#league-clip {
  overflow: hidden;
}

#league-track {
  display: flex;
  will-change: transform;
}

.league-slide {
  min-width: 100%;
  flex-shrink: 0;
  box-sizing: border-box;
}

@keyframes league-peek {
  0% { transform: translateX(0); }
  40% { transform: translateX(-30px); }
  100% { transform: translateX(0); }
}

/* ── Habit Completion Celebration ── */

@keyframes habit-glow {
  0% { box-shadow: 0 0 0 0 rgba(0, 200, 160, 0); border-color: rgba(42, 42, 78, 0.3); }
  40% { box-shadow: 0 0 20px 4px rgba(0, 200, 160, 0.25); border-color: #00c8a0; }
  100% { box-shadow: 0 0 0 0 rgba(0, 200, 160, 0); border-color: rgba(42, 42, 78, 0.3); }
}

.habits-complete {
  animation: habit-glow 0.8s ease-out;
}

/* ── Page Transitions ── */

@media (prefers-reduced-motion: no-preference) {
  .page {
    transition: opacity 0.15s ease;
  }

  .page-exit {
    opacity: 0;
  }

  .page-enter {
    opacity: 0;
  }

  .page-enter-active {
    opacity: 1;
  }
}
